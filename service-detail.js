// ========================================
// SERVICE DATA
// ========================================

const servicesData = {
    decoration: {
        title: 'الزينة والديكور',
        description: 'نقدم خدمات زينة وديكور عصرية وفاخرة لتحويل منزلك إلى حلم. فريقنا المتخصص يعمل على تصاميم فريدة تناسب ذوقك واحتياجاتك.',
        longDescription: 'مع خبرة تزيد عن 10 سنوات في مجال الديكور والزينة، نقدم لك حلولاً متكاملة تجمع بين الفن والوظيفة. نستخدم أفضل المواد والتقنيات الحديثة لضمان نتائج استثنائية تعكس شخصيتك وذوقك الرفيع.',
        features: [
            { icon: 'fas fa-palette', title: 'تصاميم عصرية', description: 'أحدث التصاميم والأفكار الديكورية المتوافقة مع الاتجاهات العالمية' },
            { icon: 'fas fa-brush', title: 'ألوان متناسقة', description: 'اختيار الألوان المناسبة لمنزلك بناءً على دراسة احترافية' },
            { icon: 'fas fa-users', title: 'فريق متخصص', description: 'فريق محترف وذو خبرة عالية في مجال الديكور والتصميم الداخلي' },
            { icon: 'fas fa-clock', title: 'تنفيذ سريع', description: 'إنجاز العمل في الوقت المحدد مع الحفاظ على الجودة العالية' },
            { icon: 'fas fa-dollar-sign', title: 'أسعار منافسة', description: 'أفضل الأسعار مع الجودة العالية والمواد الأصلية' },
            { icon: 'fas fa-award', title: 'ضمان الجودة', description: 'ضمان شامل على جودة العمل والمواد المستخدمة' },
        ],
        images: [
            'images/Decoration_Photos/IMG1.jpg',
            'images/Decoration_Photos/IMG2.jpg',
            'images/Decoration_Photos/IMG3.jpg',
            'images/Decoration_Photos/IMG4.jpg',
            'images/Decoration_Photos/IMG5.jpg',
            'images/Decoration_Photos/IMG6.jpg',
            'images/Decoration_Photos/IMG7.jpg',
            'images/Decoration_Photos/IMG8.jpg',
            'images/Decoration_Photos/IMG9.jpg',
            'images/Decoration_Photos/IMG10.jpg',
            'images/Decoration_Photos/IMG11.jpg',
            'images/Decoration_Photos/IMG12.jpg',
            'images/Decoration_Photos/IMG13.jpg',
            'images/Decoration_Photos/IMG14.jpg',
            'images/Decoration_Photos/IMG15.jpg',
            'images/Decoration_Photos/IMG16.jpg',
            'images/Decoration_Photos/IMG17.jpg',
            'images/Decoration_Photos/IMG18.jpg',
            'images/Decoration_Photos/IMG19.jpg',
            'images/Decoration_Photos/IMG20.jpg',
            'images/Decoration_Photos/IMG21.jpg',
            'images/Decoration_Photos/IMG22.jpg',
            'images/Decoration_Photos/IMG23.jpg',
            'images/Decoration_Photos/IMG24.jpg',
            'images/Decoration_Photos/IMG25.jpg',
            'images/Decoration_Photos/IMG26.jpg',
            'images/Decoration_Photos/IMG-20251114-WA0050.jpg',
            'images/Decoration_Photos/IMG-20251117-WA0014.jpg',
            'images/Decoration_Photos/IMG-20251117-WA0015.jpg',
            'images/Decoration_Photos/VID1.mp4',
            'images/Decoration_Photos/VID2.mp4',
            'images/Decoration_Photos/VID3.mp4',
            'images/Decoration_Photos/VID4.mp4',
            'images/Decoration_Photos/VID5.mp4',
            'images/Decoration_Photos/VID6.mp4',
            'images/Decoration_Photos/VID7.mp4',
            'images/Decoration_Photos/VID8.mp4',
            'images/Decoration_Photos/VID9.mp4',
            'images/Decoration_Photos/VID10.mp4',
        ]
    },
    electricity: {
        title: 'الكهرباء',
        description: 'خدمات كهربائية احترافية وآمنة تشمل التركيب والصيانة والإصلاح. نستخدم أحدث التقنيات والمواد الآمنة والموثوقة.',
        longDescription: 'نوفر خدمات كهربائية شاملة بمعايير أمان عالية جداً. فريقنا المرخص والمدرب يعمل على ضمان سلامتك وسلامة عائلتك مع الالتزام الكامل بجميع المعايير الكهربائية الدولية.',
        features: [
            { icon: 'fas fa-bolt', title: 'تركيب احترافي', description: 'تركيب كهربائي آمن وموثوق وفقاً للمعايير الدولية' },
            { icon: 'fas fa-tools', title: 'صيانة دورية', description: 'خدمات الصيانة الدورية والطارئة للأنظمة الكهربائية' },
            { icon: 'fas fa-shield-alt', title: 'معايير الأمان', description: 'التزام كامل بمعايير الأمان والسلامة الكهربائية' },
            { icon: 'fas fa-tachometer-alt', title: 'خدمة سريعة', description: 'استجابة سريعة للطلبات الطارئة والعاجلة' },
            { icon: 'fas fa-lightbulb', title: 'توفير الطاقة', description: 'حلول ذكية لتوفير استهلاك الكهرباء وتقليل الفواتير' },
            { icon: 'fas fa-headset', title: 'دعم 24/7', description: 'خدمة عملاء متاحة طوال الوقت للاستجابة السريعة' },
        ],
        images: [
            'images/Electricity_Photos/IMG1.jpg',
            'images/Electricity_Photos/IMG2.jpg',
            'images/Electricity_Photos/IMG3.jpg',
            'images/Electricity_Photos/IMG4.jpg',
            'images/Electricity_Photos/IMG5.jpg',
            'images/Electricity_Photos/IMG6.jpg',
            'images/Electricity_Photos/IMG7.jpg',
            'images/Electricity_Photos/IMG8.jpg',
            'images/Electricity_Photos/IMG9.jpg',
            'images/Electricity_Photos/IMG10.jpg',
            'images/Electricity_Photos/IMG11.jpg',
            'images/Electricity_Photos/IMG12.jpg',
            'images/Electricity_Photos/IMG13.jpg',
            'images/Electricity_Photos/IMG14.jpg',
            'images/Electricity_Photos/IMG15.jpg',
            'images/Electricity_Photos/IMG16.jpg',
            'images/Electricity_Photos/IMG17.jpg',
            'images/Electricity_Photos/IMG18.jpg',
            'images/Electricity_Photos/IMG19.jpg',
            'images/Electricity_Photos/IMG20.jpg',
            'images/Electricity_Photos/IMG21.jpg',
            'images/Electricity_Photos/IMG22.jpg',
            'images/Electricity_Photos/IMG23.jpg',
            'images/Electricity_Photos/IMG24.jpg',
            'images/Electricity_Photos/IMG25.mp4',
            'images/Electricity_Photos/IMG26.jpg',
        ]
    },
    plumbing: {
        title: 'السباكة',
        description: 'عندما تواجه مشاكل في السباكة، نحن هنا لنساعدك بكل ثقة وسرعة. فريقنا يملك الخبرة للتعامل مع أي مشكلة مهما كانت بسيطة أو معقدة.',
        longDescription: 'نوفر لك خدمات شاملة، سواء كنت بحاجة لتركيب جديد أو صيانة أو إصلاحات. نستخدم أحدث الأدوات والأساليب لنضمن لك حلًا سريعًا وفعالًا. جودة شغلنا تهمنا، وبأسعار مناسبة تناسب ميزانيتك. هدفنا رضاك الكامل، جرب خدماتنا وستلاحظ الفرق بنفسك.',
        features: [
            { icon: 'fas fa-water', title: 'إصلاح سريع', description: 'إصلاح فوري للتسريبات والأعطال بأقل وقت ممكن' },
            { icon: 'fas fa-wrench', title: 'تركيب أنابيب', description: 'تركيب أنابيب بأعلى جودة ومواد معتمدة' },
            { icon: 'fas fa-pipe', title: 'تنظيف الأنابيب', description: 'تنظيف وتسليك الأنابيب المسدودة بتقنيات حديثة' },
            { icon: 'fas fa-hammer', title: 'صيانة دورية', description: 'صيانة دورية للأنظمة السباكية لضمان عملها الأمثل' },
            { icon: 'fas fa-check-circle', title: 'ضمان العمل', description: 'ضمان شامل على جميع الأعمال والمواد المستخدمة' },
            { icon: 'fas fa-money-bill-wave', title: 'أسعار عادلة', description: 'أسعار شفافة وعادلة بدون مفاجآت أو تكاليف إضافية' },
        ],
        images: [
            'images/Plumbing_Photos/IMG1.jpg',
            'images/Plumbing_Photos/IMG2.jpg',
            'images/Plumbing_Photos/IMG3.jpg',
            'images/Plumbing_Photos/VID1.mp4',
            'images/Plumbing_Photos/VID2.mp4',
        ]
    }
};

// ========================================
// GET SERVICE FROM URL
// ========================================

function getServiceFromURL() {
    const params = new URLSearchParams(window.location.search);
    return params.get('service') || 'decoration';
}

// ========================================
// LOAD SERVICE CONTENT
// ========================================

function loadServiceContent() {
    const service = getServiceFromURL();
    const serviceData = servicesData[service];

    if (!serviceData) {
        window.location.href = 'index.html';
        return;
    }

    // Load Hero Section
    const heroSection = document.getElementById('serviceHero');
    heroSection.innerHTML = `
        <div class="service-hero-content">
            <h1>${serviceData.title}</h1>
            <p>${serviceData.description}</p>
        </div>
    `;

    // Load Description
    const descriptionSection = document.getElementById('serviceDescription');
    descriptionSection.innerHTML = `
        <div class="description-content">
            <h2>${serviceData.title}</h2>
            <p class="intro-text">${serviceData.description}</p>
            <p class="long-text">${serviceData.longDescription}</p>
            <div class="description-footer">
                <p>نحن نقدم خدمات عالية الجودة بأسعار منافسة وفريق محترف يعمل على رضاك التام. اختر خدمتنا واستمتع بالفرق.</p>
            </div>
        </div>
    `;

    // Load Features
    const featuresGrid = document.getElementById('featuresGrid');
    featuresGrid.innerHTML = serviceData.features.map(feature => `
        <div class="feature-item">
            <div class="feature-icon">
                <i class="${feature.icon}"></i>
            </div>
            <h3>${feature.title}</h3>
            <p>${feature.description}</p>
        </div>
    `).join('');

    // Load Gallery
    const galleryGrid = document.getElementById('galleryGrid');
    galleryGrid.innerHTML = serviceData.images.map((media, index) => {
        const isVideo = media.endsWith('.mp4');
        
        if (isVideo) {
            return `
                <div class="gallery-item video-item">
                    <video controls preload="metadata" style="width: 100%; height: 100%;" poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3Crect fill='%23000' width='400' height='300'/%3E%3C/svg%3E">
                        <source src="${media}" type="video/mp4">
                        متصفحك لا يدعم تشغيل الفيديو
                    </video>
                </div>
            `;
        } else {
            return `
                <div class="gallery-item">
                    <a href="${media}" data-lightbox="service-gallery" data-title="${serviceData.title} - ${index + 1}">
                        <img src="${media}" alt="${serviceData.title} ${index + 1}" loading="lazy">
                        <div class="image-overlay">
                            <i class="fas fa-expand"></i>
                        </div>
                    </a>
                </div>
            `;
        }
    }).join('');

    // Add back button to Lightbox
    addLightboxBackButton();

    // Update page title
    document.title = `${serviceData.title} - زينة تاتش`;

    // Reinitialize Lightbox
    if (typeof lightbox !== 'undefined') {
        lightbox.option({
            'resizeDuration': 200,
            'wrapAround': true,
            'albumLabel': 'صورة %1 من %2'
        });
    }
}

// ========================================
// ADD BACK BUTTON TO LIGHTBOX
// ========================================

function addLightboxBackButton() {
    // Wait for Lightbox to be ready
    setTimeout(() => {
        const lightboxElements = document.querySelectorAll('[data-lightbox]');
        
        lightboxElements.forEach(element => {
            element.addEventListener('click', () => {
                setTimeout(() => {
                    const lightboxContainer = document.querySelector('.lb-container');
                    if (lightboxContainer) {
                        // Check if back button already exists
                        if (!document.querySelector('.lightbox-back-btn')) {
                            const backButton = document.createElement('button');
                            backButton.className = 'lightbox-back-btn';
                            backButton.innerHTML = '<i class="fas fa-arrow-right"></i>';
                            backButton.title = 'العودة إلى المعرض';
                            backButton.addEventListener('click', (e) => {
                                e.stopPropagation();
                                // Close lightbox
                                const closeButton = document.querySelector('.lb-close');
                                if (closeButton) {
                                    closeButton.click();
                                }
                            });
                            
                            const lightboxNav = document.querySelector('.lb-nav');
                            if (lightboxNav) {
                                lightboxNav.appendChild(backButton);
                            }
                        }
                    }
                }, 100);
            });
        });
    }, 500);
}

// ========================================
// FORM SUBMISSION
// ========================================

function initializeForm() {
    const form = document.getElementById('serviceForm');
    
    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = {
            name: document.getElementById('name').value,
            phone: document.getElementById('phone').value,
            email: document.getElementById('email').value,
            message: document.getElementById('message').value,
            service: getServiceFromURL(),
            timestamp: new Date().toISOString()
        };

        // For now, just show a success message
        // Later this will be connected to the backend
        alert('شكراً لك! تم استقبال طلبك. سيتم التواصل معك قريباً.');
        form.reset();

        // Log to console (for debugging)
        console.log('Form Data:', formData);
    });
}

// ========================================
// MOBILE MENU TOGGLE
// ========================================

function initializeMobileMenu() {
    const menuToggle = document.getElementById('menuToggle');
    const navLinks = document.getElementById('navLinks');

    if (menuToggle) {
        menuToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });

        navLinks.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('active');
            });
        });
    }
}

// ========================================
// INITIALIZE ALL
// ========================================

document.addEventListener('DOMContentLoaded', () => {
    loadServiceContent();
    initializeForm();
    initializeMobileMenu();
});
